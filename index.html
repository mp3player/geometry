<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        *{margin:0;padding:0;}
        canvas{
            position:absolute;
        }
        .tools {
            position:absolute;top:0;left:0;width:100%;height:60px;background:red;
        }
        .tools ul {
            display:flex;list-style:none;
        }
        .tools ul li {
            min-width:50px;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <!-- <div class="tools">
        <ul>
            <li>pen</li>
            <li>eraser</li>
        </ul>
    </div> -->
    <script type="module">
        // import Express from './collection/express.js'
        import Stack from './collection/stack.js'

        import Painter from './shape/container/painter.js'
        import Circle from './shape/polygon/circle.js'
        import Polygon from './shape/polygon/polygon.js'
        import Ring from './shape/ring/ring.js'
        import Rectange from './shape/polygon/rectangle.js'
        import Line from './shape/path/line.js'
        import Vector from './math/vector.js'
        import Complex from './math/complex.js'
        import Calc from './math/calc.js'
        import ShapeLib from './math/shapeLib.js'

        import Axes from './util/component/axes.js'
        import Grid from './util/component/grid.js'

        import PerlinNoise from './math/noise/PerlinNoise.js'

        import ImageMap,{Color} from './shape/image/image.js'

        import LinearExpression from './shape/polynomial/linear-expression.js'
        import SquareExpression from './shape/polynomial/square-expression.js'
        import PolynomialExpression from './shape/polynomial/polynomial-expression.js'

        import {bubbleSort} from './math/sort.js'
        import Convex from './math/convex.js'
        import Cursor from './util/component/cursor.js'
        import Scale from './util/component/scale.js'
        import {Join} from './constant/Constant.js'

        import {dft,idft,eulor} from './fourier/dft.js'


        let painter = new Painter(canvas);


        let axes = new Axes(Color.RED,Color.GREEN);
        let grid = new Grid(10,10);

        painter.add(grid);
        painter.add(axes);
        painter.on('mousedown',function(e){
            console.log(e)
        })
        painter.on('mousemove',function(e){
            if(this.mousePress)
                console.log(this)
        })
        painter.on('mousewheel',function(e){
            this.translate(e)
            this.render()
        })

        // let x = [-10.05, 9.75, 19.85, 29.95, -0.05, -29.95, -20.35,-10.05];
        // let y = [19.75, 19.95, 29.75, 19.85, -10.25, 20.05, 29.55,19.75];

        let nl = JSON.parse('[[-19.65,13.75],[-19.95,13.75],[-20.05,13.65],[-20.25,13.55],[-20.65,13.25],[-21.05,13.05],[-21.45,12.85],[-22.15,12.35],[-22.65,11.75],[-23.15,11.35],[-23.45,10.85],[-23.65,10.25],[-23.75,9.55],[-23.85,8.95],[-23.85,8.55],[-23.65,8.15],[-23.45,7.75],[-23.25,7.45],[-22.95,7.05],[-22.75,6.85],[-22.55,6.75],[-22.35,6.65],[-22.15,6.65],[-21.85,6.65],[-21.65,6.75],[-21.45,6.85],[-21.15,7.05],[-20.85,7.15],[-20.65,7.25],[-20.45,7.45],[-20.15,7.85],[-19.85,8.25],[-19.65,8.65],[-19.45,9.05],[-19.35,9.35],[-19.25,9.75],[-19.25,10.15],[-19.25,10.75],[-19.25,11.15],[-19.25,11.55],[-19.25,11.85],[-19.25,12.15],[-19.25,12.35],[-19.25,12.55],[-19.15,12.85],[-19.15,13.05],[-19.15,13.25],[-19.15,13.35],[-19.15,13.45],[-19.15,13.45],[-19.15,13.45],[-19.15,13.25],[-19.15,13.05],[-19.15,12.85],[-19.15,12.75],[-19.15,12.35],[-18.95,11.45],[-18.95,10.35],[-18.95,9.55],[-19.05,9.05],[-19.05,8.45],[-19.05,7.65],[-19.15,6.55],[-19.15,5.85],[-19.15,5.05],[-19.25,4.55],[-19.35,4.25],[-19.45,3.95],[-19.65,3.55],[-19.75,3.15],[-19.85,2.85],[-20.05,2.55],[-20.15,2.45],[-20.35,2.15],[-20.45,1.95],[-20.65,1.85],[-20.85,1.65],[-20.95,1.65],[-21.15,1.45],[-21.35,1.35],[-21.65,1.25],[-21.75,1.25],[-22.15,1.15],[-22.45,1.05],[-22.55,1.05],[-22.75,1.05],[-22.95,1.05],[-22.95,1.05],[-23.05,1.05],[-23.15,1.15],[-23.15,1.25],[-23.15,1.25],[-23.15,1.45],[-22.95,1.65],[-22.85,1.75],[-22.45,2.15],[-22.25,2.35],[-22.05,2.55],[-21.75,2.95],[-21.35,3.25],[-21.05,3.55],[-20.65,4.05],[-20.05,4.55],[-19.15,5.25],[-18.55,5.65],[-18.05,6.15],[-17.45,6.65],[-16.95,7.15],[-16.45,7.45],[-15.95,7.95],[-15.25,8.55],[-14.65,8.95],[-14.15,9.35],[-13.55,9.75],[-13.25,10.05],[-12.95,10.25],[-12.75,10.65],[-12.65,10.75],[-12.55,10.75],[-12.55,10.75],[-12.45,10.75],[-12.45,10.65],[-12.55,10.45],[-12.75,10.25],[-12.85,9.85],[-13.05,9.45],[-13.35,8.95],[-13.45,8.45],[-13.65,8.05],[-13.85,7.65],[-13.85,7.25],[-13.85,6.95],[-13.75,6.55],[-13.65,6.15],[-13.45,5.75],[-13.25,5.35],[-13.05,5.15],[-12.85,5.05],[-12.75,4.95],[-12.55,4.85],[-12.35,4.85],[-12.15,4.85],[-11.75,4.85],[-11.35,5.05],[-11.05,5.25],[-10.75,5.45],[-10.35,5.85],[-10.05,6.15],[-9.75,6.45],[-9.45,6.75],[-9.25,7.05],[-9.05,7.35],[-8.95,7.45],[-8.95,7.85],[-8.95,8.05],[-9.05,8.25],[-9.25,8.55],[-9.35,8.85],[-9.45,8.95],[-9.65,9.15],[-9.75,9.35],[-9.85,9.55],[-10.05,9.65],[-10.15,9.75],[-10.35,9.85],[-10.45,9.85],[-10.55,9.85],[-10.65,9.85],[-10.75,9.85],[-10.85,9.85],[-10.95,9.85],[-11.05,9.85],[-11.05,9.85],[-11.05,9.75],[-11.15,9.75],[-11.25,9.75],[-11.25,9.65],[-11.25,9.65],[-11.35,9.45],[-11.35,9.35],[-11.35,9.15],[-11.35,9.05],[-11.35,8.85],[-11.25,8.65],[-11.25,8.45],[-11.15,8.35],[-11.05,8.35],[-11.05,8.35],[-10.85,8.25],[-10.55,8.15],[-10.25,8.15],[-9.85,8.15],[-9.25,8.15],[-8.75,8.15],[-8.35,8.25],[-7.95,8.35],[-7.55,8.55],[-7.05,8.65],[-6.55,8.85],[-5.95,9.15],[-5.55,9.45],[-5.15,9.65],[-4.65,9.95],[-4.35,10.15],[-3.95,10.35],[-3.85,10.45],[-3.55,10.55],[-3.45,10.65],[-3.35,10.75],[-3.15,10.85],[-3.15,10.85],[-3.15,10.85],[-3.15,10.85],[-3.25,10.85],[-3.35,10.75],[-3.45,10.75],[-3.65,10.65],[-3.75,10.45],[-3.85,10.35],[-3.95,10.15],[-4.05,9.95],[-4.05,9.75],[-4.15,9.35],[-4.15,9.05],[-4.15,8.75],[-4.15,8.25],[-4.15,7.85],[-4.15,7.45],[-4.05,7.15],[-4.05,6.85],[-3.95,6.65],[-3.85,6.55],[-3.85,6.45],[-3.75,6.35],[-3.55,6.25],[-3.25,6.15],[-3.05,6.05],[-2.75,6.05],[-2.55,6.05],[-2.15,6.05],[-1.75,6.05],[-1.25,6.05],[-0.95,6.15],[-0.75,6.25],[-0.45,6.55],[-0.15,6.75],[0.25,6.95],[0.55,7.25],[0.75,7.35],[1.05,7.55],[1.25,7.65],[1.25,7.75],[1.25,7.95],[1.25,8.05],[1.25,8.15],[1.25,8.35],[1.15,8.55],[1.05,8.75],[0.95,8.85],[0.85,9.05],[0.75,9.15],[0.55,9.25],[0.35,9.45],[0.05,9.55],[-0.25,9.75],[-0.45,9.75],[-0.65,9.85],[-0.75,9.85],[-0.95,9.85],[-1.05,9.85],[-1.25,9.85],[-1.35,9.85],[-1.35,9.85],[-1.45,9.85],[-1.55,9.85],[-1.55,9.75],[-1.55,9.65],[-1.25,9.55],[-1.05,9.35],[-0.85,9.25],[-0.65,9.15],[-0.45,9.05],[-0.25,9.05],[-0.05,8.95],[0.25,8.85],[0.55,8.85],[0.65,8.75],[0.95,8.75],[1.15,8.75],[1.35,8.75],[1.55,8.75],[1.85,8.75],[2.35,8.85],[2.75,8.85],[3.15,8.85],[3.55,8.85],[3.95,8.95],[4.35,9.05],[4.65,9.15],[4.95,9.25],[5.45,9.45],[5.95,9.55],[6.35,9.65],[6.65,9.85],[7.05,9.95],[7.35,10.05],[7.55,10.15],[7.65,10.25],[7.75,10.35],[7.75,10.45],[7.75,10.45],[7.75,10.45],[7.75,10.45],[7.75,10.45],[7.75,10.45],[7.65,10.45],[7.55,10.35],[7.45,10.15],[7.35,10.05],[7.15,9.95],[7.05,9.75],[6.85,9.65],[6.75,9.45],[6.65,9.35],[6.55,9.25],[6.45,9.05],[6.35,8.85],[6.25,8.65],[6.05,8.25],[6.05,7.75],[5.95,7.35],[5.85,6.95],[5.85,6.55],[5.85,6.35],[5.85,6.25],[5.85,6.05],[5.85,6.05],[5.85,5.95],[5.85,5.85],[5.95,5.75],[6.05,5.65],[6.15,5.55],[6.35,5.55],[6.85,5.35],[7.25,5.25],[7.65,5.25],[7.95,5.25],[8.15,5.25],[8.35,5.25],[8.45,5.35],[8.55,5.55],[8.65,5.75],[8.85,5.85],[9.05,6.25],[9.25,6.85],[9.45,7.55],[9.75,8.25],[10.05,9.05],[10.25,9.75],[10.55,10.45],[10.75,11.25],[11.05,11.95],[11.25,12.45],[11.35,12.85],[11.35,13.35],[11.45,14.05],[11.45,14.45],[11.45,14.75],[11.45,15.05],[11.55,15.35],[11.55,15.55],[11.65,16.05],[11.65,16.45],[11.75,16.75],[11.75,17.15],[11.85,17.45],[11.85,17.75],[11.85,17.95],[11.85,18.05],[11.85,18.15],[11.95,18.25],[11.95,18.25],[11.95,18.15],[11.95,17.85],[11.85,17.45],[11.75,17.05],[11.65,16.75],[11.55,16.45],[11.35,15.65],[11.25,14.95],[11.15,14.15],[11.05,13.05],[11.05,12.45],[11.05,11.95],[11.05,11.35],[11.05,10.95],[11.05,10.55],[11.05,10.05],[11.15,9.75],[11.15,9.45],[11.15,9.25],[11.15,9.15],[11.15,8.95],[11.15,8.85],[11.15,8.65],[11.35,8.45],[11.55,8.25],[11.75,7.95],[11.95,7.65],[12.25,7.45],[12.45,7.25],[12.55,7.15],[12.75,7.05],[12.95,6.95],[13.15,6.85],[13.45,6.65],[13.65,6.55],[13.95,6.45],[14.15,6.35],[14.35,6.25],[14.55,6.25],[14.75,6.25],[14.95,6.25],[15.15,6.25],[15.45,6.25],[15.55,6.25],[15.55,6.25],[15.65,6.25],[15.65,6.25],[15.65,6.25],[15.65,6.25],[15.65,6.25]]')
        
        let arr = [];

        // console.log(nl)

        for(let i=0;i<nl.length;++i){
            arr.push(
                new Complex(nl[i][0]/500,nl[i][1] / 500)
            )
        }
        console.log(nl);

        let transform = dft(arr);

        let N = transform.length;
        let circles = [];
        let lines = []
        let flag = false;
        let points = []
        setInterval(() => {
            let s = new Complex(0,0);
            
            for(let i=0;i<N;++i){
                let j = i;
                let c = transform[i].mul(eulor(2 * Math.PI * j / N));

                if(flag == false){
                    let circle = new Circle(s.r,s.i,c.mod(),{
                        borderColor:Color.RED5
                    });
                    let line = new Line([s.toVector(),s.add(c).toVector()],{
                        borderColor:Color.BLACK2
                    });
                    painter.add(line);
                    painter.add(circle);
                    circles.push(circle);
                    lines.push(line);
                    
                }else{
                    circles[i].center = new Vector(s.r,s.i);
                    lines[i].points = [s.toVector(),s.add(c).toVector()]
                }
                
                s = s.add(c);
                transform[i] = c;
            }
            if(points.length < 10000)
             points.push(s.toVector())
            // console.log(transform)
            flag = true;
        }, 10);

        
        let polygon = new Polygon(points)

        console.log(polygon)

        painter.add(polygon);
     
        let a1 = []
        let a = []
        let line = new Line(a1)

            painter.on('mousemove',function(ev){
                if(this.mousePress){
                    let ar = `[${ev.x},${ev.y}]`;
                    a.push(ar);
                    a1.push(ev);
                    console.log(ev)
                }
            })
        window.a = a;
        

        painter.add(line);

        painter.loopRender();
    </script>
</body>
</html>
